/* eslint-disable */
(function () {
    const exports = {};
"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _lodash=require("lodash");var _DefaultOptions=require("./DefaultOptions");var _DefaultOptions2=_interopRequireDefault(_DefaultOptions);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var ImageResize=function e(t){var i=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,e);this.handleClick=function(e){if(e.target&&e.target.tagName&&e.target.tagName.toUpperCase()==="IMG"){if(i.img===e.target){return}if(i.img){i.hide()}i.show(e.target)}else if(i.img){i.hide()}};this.show=function(e){i.img=e;i.showResizers();i.showSizeDisplay();var t=i.img.getBoundingClientRect();i.positionBoxes(t);i.positionSizeDisplay(t)};this.hide=function(){i.hideResizers();i.hideSizeDisplay();i.img=undefined};this.showResizers=function(){i.setUserSelect("none");i.addBox("nwse-resize");i.addBox("nesw-resize");i.addBox("nwse-resize");i.addBox("nesw-resize");document.addEventListener("keyup",i.checkImage,true);i.quill.root.addEventListener("input",i.checkImage,true)};this.hideResizers=function(){document.removeEventListener("keyup",i.checkImage);i.quill.root.removeEventListener("input",i.checkImage);i.setUserSelect("");i.setCursor("");i.boxes.forEach(function(e){return document.body.removeChild(e)});i.dragBox=undefined;i.dragStartX=undefined;i.preDragWidth=undefined;i.boxes=[]};this.addBox=function(e){var t=document.createElement("div");Object.assign(t.style,i.options.handleStyles);t.style.cursor=e;t.style.width=i.options.handleStyles.width+"px";t.style.height=i.options.handleStyles.height+"px";t.addEventListener("mousedown",i.handleMousedown,false);document.body.appendChild(t);i.boxes.push(t)};this.positionBoxes=function(e){var t=i.options.handleStyles.width/2;var n=i.options.handleStyles.height/2;[{left:e.left-t,top:e.top-n},{left:e.left+e.width-t,top:e.top-n},{left:e.left+e.width-t,top:e.top+e.height-n},{left:e.left-t,top:e.top+e.height-n}].forEach(function(e,t){Object.assign(i.boxes[t].style,{top:Math.round(e.top+window.pageYOffset)+"px",left:Math.round(e.left+window.pageXOffset)+"px"})})};this.handleMousedown=function(e){i.dragBox=e.target;i.dragStartX=e.clientX;i.preDragWidth=i.img.width||i.img.naturalWidth;i.setCursor(i.dragBox.style.cursor);document.addEventListener("mousemove",i.handleDrag,false);document.addEventListener("mouseup",i.handleMouseup,false)};this.handleMouseup=function(){i.setCursor("");document.removeEventListener("mousemove",i.handleDrag);document.removeEventListener("mouseup",i.handleMouseup)};this.handleDrag=function(e){if(!i.img){return}if(i.dragBox===i.boxes[0]||i.dragBox===i.boxes[3]){i.img.width=Math.round(i.preDragWidth-e.clientX-i.dragStartX)}else{i.img.width=Math.round(i.preDragWidth+e.clientX-i.dragStartX)}var t=i.img.getBoundingClientRect();i.positionBoxes(t);i.positionSizeDisplay(t)};this.setUserSelect=function(e){["userSelect","mozUserSelect","webkitUserSelect","msUserSelect"].forEach(function(t){i.quill.root.style[t]=e;document.documentElement.style[t]=e})};this.setCursor=function(e){[document.body,i.img,i.quill.root].forEach(function(t){t.style.cursor=e})};this.checkImage=function(){if(i.img){i.hide()}};this.showSizeDisplay=function(){if(!i.options.displaySize){return}i.display=document.createElement("div");Object.assign(i.display.style,i.options.displayStyles);document.body.appendChild(i.display)};this.hideSizeDisplay=function(){if(i.display){document.body.removeChild(i.display)}i.display=undefined};this.positionSizeDisplay=function(e){if(!i.display||!i.img){return}var t=i.getCurrentSize();i.display.innerHTML=t.join(" &times; ");if(t[0]>120&&t[1]>30){var n=i.display.getBoundingClientRect();Object.assign(i.display.style,{left:Math.round(e.left+e.width+window.pageXOffset-n.width-8)+"px",top:Math.round(e.top+e.height+window.pageYOffset-n.height-8)+"px"})}else{Object.assign(i.display.style,{left:Math.round(e.left+e.width+window.pageXOffset+8)+"px",top:Math.round(e.top+e.height+window.pageYOffset+8)+"px"})}};this.getCurrentSize=function(){return[i.img.width,Math.round(i.img.width/i.img.naturalWidth*i.img.naturalHeight)]};this.quill=t;this.options=(0,_lodash.defaultsDeep)({},n,_DefaultOptions2.default);this.boxes=[];document.execCommand("enableObjectResizing",false,"false");this.quill.root.addEventListener("click",this.handleClick,false)};exports.default=ImageResize;
    window.Quill.register('modules/imageResize', exports.ImageResize);
}());
